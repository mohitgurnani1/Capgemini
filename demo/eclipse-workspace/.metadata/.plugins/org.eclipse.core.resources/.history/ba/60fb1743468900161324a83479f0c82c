package com.flp.ems.dao;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.Properties;

public class JDBC {

	public static void main(String[] args) throws Exception{
		
		Properties prop=new Properties();
		prop.load(new FileInputStream("dbDetails.properties"));
		
		String url=prop.getProperty("jdbc.url");
		String uname=prop.getProperty("jdbc.username");
		String pwd=prop.getProperty("jdbc.password");
		String[] roles={"Developer","Tech Lead","Manager","Business Analyst","Product Owner","Client"};
		
		
		try(Connection conn=DriverManager.getConnection(url,uname,pwd);){
				String sql=prop.getProperty("jdbc.insertQuery");
				try(PreparedStatement ps=conn.prepareStatement(sql);){
						for(int i=0;i<roles.length;i++){
						ps.setString(1, "r"+(i+1));
						ps.setString(2, roles[i]);
						ps.setString(3, "Good");
						System.out.println("Rows effected   "+ps.executeUpdate());
						}
					}
		}
		
		
		
		
		
	}
	
}
